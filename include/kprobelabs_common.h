#ifndef _KPROBELABS_COMMON_H
#define _KPROBELABS_COMMON_H

enum {
    KPROBELABS_FUNCINDEX_KMALLOC,
    KPROBELABS_FUNCINDEX_DUMP_BACKTRACE,
    KPROBELABS_FUNCINDEX_PROC,
};

struct kmallocArgs {
    int size;
    int bMalloc;
};

#define DEVICE_NAME "kprobelabs"
#define DEVICE_PATH "/dev/kprobelabs"

#define KPROBELABS_IOCTL_MAGIC 'k'
#define KPROBELABS_IOCTL_KMALLOC _IOC(_IOC_WRITE, KPROBELABS_IOCTL_MAGIC, KPROBELABS_FUNCINDEX_KMALLOC, sizeof(struct kmallocArgs))
#define KPROBELABS_IOCTL_DUMP_BACKTRACE _IOC(_IOC_WRITE, KPROBELABS_IOCTL_MAGIC, KPROBELABS_FUNCINDEX_DUMP_BACKTRACE, 0)
#define KPROBELABS_IOCTL_PROC _IOC(_IOC_WRITE, KPROBELABS_IOCTL_MAGIC, KPROBELABS_FUNCINDEX_PROC, sizeof(int))


#endif
