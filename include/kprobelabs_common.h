#ifndef _KPROBELABS_COMMON_H
#define _KPROBELABS_COMMON_H

enum {
    KPROBELABS_FUNCINDEX_KMALLOC,
    KPROBELABS_FUNCINDEX_DUMP_BACKTRACE,
};

#define DEVICE_NAME "kprobelabs"
#define DEVICE_PATH "/dev/kprobelabs"

#define KPROBELABS_IOCTL_MAGIC 'k'
#define KPROBELABS_IOCTL_KMALLOC _IOC(_IOC_WRITE, KPROBELABS_IOCTL_MAGIC, KPROBELABS_FUNCINDEX_KMALLOC, sizeof(int))
#define KPROBELABS_IOCTL_DUMP_BACKTRACE _IOC(_IOC_WRITE, KPROBELABS_IOCTL_MAGIC, KPROBELABS_FUNCINDEX_DUMP_BACKTRACE, 0)

#endif
